
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="X-UA-Compatible" content="IE=Edge" />
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <title>Installation &#8212; CaImAn 1.4 documentation</title>
    <link rel="stylesheet" href="_static/nature.css" type="text/css" />
    <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    <script type="text/javascript" id="documentation_options" data-url_root="./" src="_static/documentation_options.js"></script>
    <script type="text/javascript" src="_static/jquery.js"></script>
    <script type="text/javascript" src="_static/underscore.js"></script>
    <script type="text/javascript" src="_static/doctools.js"></script>
    <script type="text/javascript" src="_static/language_data.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Demos" href="Getting_Started.html" />
    <link rel="prev" title="Overview" href="Overview.html" /> 
  </head><body>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="Getting_Started.html" title="Demos"
             accesskey="N">next</a> |</li>
        <li class="right" >
          <a href="Overview.html" title="Overview"
             accesskey="P">previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="index.html">CaImAn 1.4 documentation</a> &#187;</li> 
      </ul>
    </div>  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <div class="section" id="installation">
<h1>Installation<a class="headerlink" href="#installation" title="Permalink to this headline">¶</a></h1>
<p>Download and install Anaconda or Miniconda (Python 3.x version)
<a class="reference external" href="http://docs.continuum.io/anaconda/install">http://docs.continuum.io/anaconda/install</a></p>
<div class="section" id="installation-on-windows">
<h2>Installation on Windows<a class="headerlink" href="#installation-on-windows" title="Permalink to this headline">¶</a></h2>
<details><p>The Windows installation process differs more widely from installation
on Linux or MacOSX and has different issues you may run into.</p>
</div>
<div class="section" id="process">
<h2>Process<a class="headerlink" href="#process" title="Permalink to this headline">¶</a></h2>
<ul class="simple">
<li>Increase the maximum size of your pagefile to 64G or more
(<a class="reference external" href="http://www.tomshardware.com/faq/id-2864547/manage-virtual-memory-pagefile-windows.html">http://www.tomshardware.com/faq/id-2864547/manage-virtual-memory-pagefile-windows.html</a>
) - The Windows memmap interface is sensitive to the maximum setting
and leaving it at the default can cause errors when processing larger
datasets<ul>
<li>Download and install Anaconda (Python 3.x)
<a class="reference external" href="http://docs.continuum.io/anaconda/install">http://docs.continuum.io/anaconda/install</a>. Allow the installer to
modify your PATH variable</li>
<li>Use Conda to install git (With “conda install git”) - use of
another commandline git is acceptable, but may lead to issues
depending on default settings</li>
<li>Install Microsoft Build Tools for Visual Studio 2017
<a class="reference external" href="https://www.visualstudio.com/downloads/#build-tools-for-visual-studio-2017">https://www.visualstudio.com/downloads/#build-tools-for-visual-studio-2017</a>.
Check the “Build Tools” box, and in the detailed view on the right
check the “C/C++ CLI Tools” component too. The specifics of this
occasionally change as Microsoft changes its products and website;
you may need to go off-script.</li>
</ul>
</li>
</ul>
<p>Use the following menu item to launch a anaconda-enabled command prompt:
start&gt;programs&gt;anaconda3&gt;anaconda prompt From that prompt. issue the
following commands (if you wish to use the dev branch, you may switch
branches after the clone):</p>
<div class="code bash highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">git</span> <span class="n">clone</span> <span class="n">https</span><span class="p">:</span><span class="o">//</span><span class="n">github</span><span class="o">.</span><span class="n">com</span><span class="o">/</span><span class="n">flatironinstitute</span><span class="o">/</span><span class="n">CaImAn</span>
<span class="n">cd</span> <span class="n">CaImAn</span>
<span class="n">conda</span> <span class="n">env</span> <span class="n">create</span> <span class="o">-</span><span class="n">f</span> <span class="n">environment</span><span class="o">.</span><span class="n">yml</span> <span class="o">-</span><span class="n">n</span> <span class="n">caiman</span>
<span class="n">conda</span> <span class="n">install</span> <span class="o">-</span><span class="n">n</span> <span class="n">caiman</span> <span class="n">vs2017_win</span><span class="o">-</span><span class="mi">64</span>
</pre></div>
</div>
<p>At this point you will want to remove a startup script that visual
studio made for your conda environment that can cause conda to crash
while entering the caiman environment. Use the Windows find-file utility
(under the Start Menu) to look for vs2015_compiler_vars.bat and/or
vs2015_compiler_vars.bat under your home directory. At least one copy
should show up. Delete the version that has
conda:raw-latex:<cite>envs</cite>envs`:raw-latex:<cite>caiman</cite>,
and edit it so KERAS_BACKEND is set to tensorflow rather than theano.
You may then continue the installation.</p>
<div class="code bash highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">activate</span> <span class="n">caiman</span>
<span class="n">pip</span> <span class="n">install</span> <span class="o">.</span> <span class="p">(</span><span class="n">OR</span> <span class="n">pip</span> <span class="n">install</span> <span class="o">-</span><span class="n">e</span> <span class="o">.</span> <span class="k">if</span> <span class="n">you</span> <span class="n">want</span> <span class="n">to</span> <span class="n">develop</span> <span class="n">code</span><span class="p">)</span>
<span class="n">copy</span> <span class="n">caimanmanager</span><span class="o">.</span><span class="n">py</span> <span class="o">..</span>
<span class="n">conda</span> <span class="n">install</span> <span class="n">numba</span>
<span class="n">cd</span> <span class="o">..</span>
</pre></div>
</div>
</div>
<div class="section" id="setting-up-a-data-directory-with-caimanmanager">
<h2>Setting up a data directory with caimanmanager<a class="headerlink" href="#setting-up-a-data-directory-with-caimanmanager" title="Permalink to this headline">¶</a></h2>
<p>Now that you have stepped out of the caiman source directory, you are
ready to make a data directory with code samples and datasets. You will
not use the source tree directory any more.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">caimanmanager</span><span class="o">.</span><span class="n">py</span> <span class="n">install</span>
</pre></div>
</div>
<p>or <code class="docutils literal notranslate"><span class="pre">python</span> <span class="pre">caimanmanager.py</span> <span class="pre">install</span> <span class="pre">--inplace</span></code> if you used “pip
install -e .”</p>
<p>This will place that directory under your home directory in a directory
called caiman_data. If you have, some of the demos or datafiles may have
changed since your last install, to follow API changes. You can check to
see if they have by doing <code class="docutils literal notranslate"><span class="pre">caimanmanager.py</span> <span class="pre">check</span></code>. If they have not,
you may keep using them. If they have, we recommend moving your old
caiman data directory out of the way (or just remove them if you have no
precious data) and doing a new data install as per above.</p>
<p>If you prefer to manage this information somewhere else, the
<code class="docutils literal notranslate"><span class="pre">CAIMAN_DATA</span></code> environment variable can be set to customise it. The
caimanmanager tool and other libraries will respect that.</p>
</div>
<div class="section" id="setting-up-environment-variables">
<h2>Setting up environment variables<a class="headerlink" href="#setting-up-environment-variables" title="Permalink to this headline">¶</a></h2>
<p>To make the package work <em>efficiently</em> and eliminate “crosstalk” between
different processes, run these commands before launching Python:</p>
<div class="code bash highlight-default notranslate"><div class="highlight"><pre><span></span><span class="nb">set</span> <span class="n">MKL_NUM_THREADS</span><span class="o">=</span><span class="mi">1</span>
<span class="nb">set</span> <span class="n">OPENBLAS_NUM_THREADS</span><span class="o">=</span><span class="mi">1</span>
<span class="nb">set</span> <span class="n">KERAS_BACKEND</span><span class="o">=</span><span class="n">tensorflow</span>
</pre></div>
</div>
<p>The commands should be run every time you enter the caiman conda
environment. We recommend you save these values inside your environment
so you do not have to repeat this process every time. You can do this by
following the instructions
<a class="reference external" href="https://conda.io/projects/conda/en/latest/user-guide/tasks/manage-environments.html#saving-environment-variables">here</a>.</p>
</details></div>
<div class="section" id="installation-on-macos-and-linux">
<h2>Installation on MacOS and Linux<a class="headerlink" href="#installation-on-macos-and-linux" title="Permalink to this headline">¶</a></h2>
<details><div class="code bash highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">git</span> <span class="n">clone</span> <span class="n">https</span><span class="p">:</span><span class="o">//</span><span class="n">github</span><span class="o">.</span><span class="n">com</span><span class="o">/</span><span class="n">flatironinstitute</span><span class="o">/</span><span class="n">CaImAn</span>
<span class="n">cd</span> <span class="n">CaImAn</span><span class="o">/</span>
<span class="n">conda</span> <span class="n">env</span> <span class="n">create</span> <span class="o">-</span><span class="n">f</span> <span class="n">environment</span><span class="o">.</span><span class="n">yml</span> <span class="o">-</span><span class="n">n</span> <span class="n">caiman</span>
<span class="n">source</span> <span class="n">activate</span> <span class="n">caiman</span>
<span class="n">pip</span> <span class="n">install</span> <span class="o">.</span>
</pre></div>
</div>
<p>If you want to develop code then replace the last command with
<code class="docutils literal notranslate"><span class="pre">pip</span> <span class="pre">install</span> <span class="pre">-e</span> <span class="pre">.</span></code> If any of these steps gives you errors do not
proceed to the following step without resolving it</p>
<div class="section" id="known-issues">
<h3>known issues<a class="headerlink" href="#known-issues" title="Permalink to this headline">¶</a></h3>
<p>If you recently upgraded to OSX Mojave you may need to perform the
following steps before your first install:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">xcode</span><span class="o">-</span><span class="n">select</span> <span class="o">--</span><span class="n">install</span>
<span class="nb">open</span> <span class="o">/</span><span class="n">Library</span><span class="o">/</span><span class="n">Developer</span><span class="o">/</span><span class="n">CommandLineTools</span><span class="o">/</span><span class="n">Packages</span><span class="o">/</span>
</pre></div>
</div>
<p>and install the package file you will find in the folder that pops up</p>
</div>
</div>
<div class="section" id="setting-up-environment-variables-1">
<span id="id1"></span><h2>Setting up environment variables<a class="headerlink" href="#setting-up-environment-variables-1" title="Permalink to this headline">¶</a></h2>
<p>To make the package work <em>efficiently</em> and eliminate “crosstalk” between
different processes, run these commands before launching Python (this is
for Linux and OSX):</p>
<div class="code bash highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">export</span> <span class="n">MKL_NUM_THREADS</span><span class="o">=</span><span class="mi">1</span>
<span class="n">export</span> <span class="n">OPENBLAS_NUM_THREADS</span><span class="o">=</span><span class="mi">1</span>
<span class="n">export</span> <span class="n">KERAS_BACKEND</span><span class="o">=</span><span class="n">tensorflow</span>
</pre></div>
</div>
<p>The commands should be run every time before launching python. It is
recommended that you save these values inside your environment so you
don’t have to repeat this process every time. You can do this by
following the instructions
<a class="reference external" href="https://conda.io/projects/conda/en/latest/user-guide/tasks/manage-environments.html#saving-environment-variables">here</a>.</p>
</div>
<div class="section" id="setting-up-caimanmanager">
<h2>Setting up caimanmanager<a class="headerlink" href="#setting-up-caimanmanager" title="Permalink to this headline">¶</a></h2>
<p>Once CaImAn is installed, you may want to get a working directory with
code samples and datasets; pip installed a caimanmanager.py command that
manages this. If you have not installed Caiman before, you can do
<code class="docutils literal notranslate"><span class="pre">caimanmanager.py</span> <span class="pre">install</span></code> or
<code class="docutils literal notranslate"><span class="pre">python</span> <span class="pre">caimanmanager.py</span> <span class="pre">install</span> <span class="pre">--inplace</span></code> if you used “pip install
-e .”</p>
<p>This will place that directory under your home directory in a directory
called caiman_data. If you have, some of the demos or datafiles may have
changed since your last install, to follow API changes. You can check to
see if they have by doing <code class="docutils literal notranslate"><span class="pre">caimanmanager.py</span> <span class="pre">check</span></code>. If they have not,
you may keep using them. If they have, we recommend moving your old
caiman data directory out of the way (or just remove them if you have no
precious data) and doing a new data install as per above.</p>
<p>If you prefer to manage this information somewhere else, the
<code class="docutils literal notranslate"><span class="pre">CAIMAN_DATA</span></code> environment variable can be set to customise it. The
caimanmanager tool and other libraries will respect that.</p>
</details></div>
</div>
<div class="section" id="upgrading">
<h1>Upgrading<a class="headerlink" href="#upgrading" title="Permalink to this headline">¶</a></h1>
<p>If you already have CaImAn installed with the pip installer (May 2018 or
later), but want to upgrade, please follow the procedure below. If you
reinstall CaImAn frequently, you can try skip deleting and recreating
your Conda environment. In this case you can do only steps 1, 5, and 7
below to update the code. However, if the environment file has changed
since your last update this may lead to you not the latest version.</p>
<p>From the conda environment you used to install CaImAn:</p>
<ol class="arabic simple">
<li><code class="docutils literal notranslate"><span class="pre">pip</span> <span class="pre">uninstall</span> <span class="pre">caiman</span></code></li>
<li>remove or rename your ~/caiman_data directory</li>
<li>Remove your conda environment: <code class="docutils literal notranslate"><span class="pre">conda</span> <span class="pre">env</span> <span class="pre">remove</span> <span class="pre">-n</span> <span class="pre">NAME_OF_YOUR_ENVIRONMENT</span></code></li>
<li>Close and reopen your shell (to clear out the old conda environment)</li>
<li>Do a <code class="docutils literal notranslate"><span class="pre">git</span> <span class="pre">pull</span></code> from inside your CaImAn folder.</li>
<li>Recreate and reenter your conda environment as you did in the installation instructions</li>
<li>Do a <code class="docutils literal notranslate"><span class="pre">pip</span> <span class="pre">install</span> <span class="pre">.</span></code> inside that code checkout</li>
<li>Run <code class="docutils literal notranslate"><span class="pre">caimanmanager.py</span> <span class="pre">install</span></code> to reinstall the data directory (use <code class="docutils literal notranslate"><span class="pre">--inplace</span></code> if you used the <code class="docutils literal notranslate"><span class="pre">pip</span> <span class="pre">install</span> <span class="pre">-e</span> <span class="pre">.</span></code> during your initial installation).</li>
</ol>
<ul class="simple">
<li>If you used the <code class="docutils literal notranslate"><span class="pre">pip</span> <span class="pre">install</span> <span class="pre">-e</span> <span class="pre">.</span></code> option when installing, then you
can try updating by simply doing a <code class="docutils literal notranslate"><span class="pre">git</span> <span class="pre">pull</span></code>. Again, this might
not lead to the latest version of the code if the environment
variables have changed.</li>
<li>The same applies if you want to modify some internal function of
CaImAn. If you used the <code class="docutils literal notranslate"><span class="pre">pip</span> <span class="pre">install</span> <span class="pre">-e</span> <span class="pre">.</span></code> option then you can
directly modify it (that’s why it’s called developer mode). If you
used the <code class="docutils literal notranslate"><span class="pre">pip</span> <span class="pre">install</span> <span class="pre">.</span></code> option then you will need to
<code class="docutils literal notranslate"><span class="pre">pip</span> <span class="pre">uninstall</span> <span class="pre">caiman</span></code> followed by <code class="docutils literal notranslate"><span class="pre">pip</span> <span class="pre">install</span> <span class="pre">.</span></code> for your
changes to take effect. Depending on the functions you’re changing so
you might be able to skip this step.</li>
</ul>
</div>
<div class="section" id="installing-additional-packages">
<h1>Installing additional packages<a class="headerlink" href="#installing-additional-packages" title="Permalink to this headline">¶</a></h1>
<p>CaImAn uses the conda-forge conda channel for installing its required
packages. If you want to install new packages into your conda
environment for CaImAn, it is important that you not mix conda-forge and
the defaults channel; we recommend only using conda-forge. To ensure
you’re not mixing channels, perform the install (inside your
environment) as follows:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">conda</span> <span class="n">install</span> <span class="o">-</span><span class="n">c</span> <span class="n">conda</span><span class="o">-</span><span class="n">forge</span> <span class="o">--</span><span class="n">override</span><span class="o">-</span><span class="n">channels</span> <span class="n">NEW_PACKAGE_NAME</span>
</pre></div>
</div>
<p>You will notice that any packages installed this way will mention, in
their listing, that they’re from conda-forge, with none of them having a
blank origin. If you fail to do this, differences between how packages
are built in conda-forge versus the default conda channels may mean that
some packages (e.g.&nbsp;OpenCV) stop working despite showing as installed.</p>
</div>


          </div>
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
  <h3><a href="index.html">Table of Contents</a></h3>
  <ul>
<li><a class="reference internal" href="#">Installation</a><ul>
<li><a class="reference internal" href="#installation-on-windows">Installation on Windows</a></li>
<li><a class="reference internal" href="#process">Process</a></li>
<li><a class="reference internal" href="#setting-up-a-data-directory-with-caimanmanager">Setting up a data directory with caimanmanager</a></li>
<li><a class="reference internal" href="#setting-up-environment-variables">Setting up environment variables</a></li>
<li><a class="reference internal" href="#installation-on-macos-and-linux">Installation on MacOS and Linux</a><ul>
<li><a class="reference internal" href="#known-issues">known issues</a></li>
</ul>
</li>
<li><a class="reference internal" href="#setting-up-environment-variables-1">Setting up environment variables</a></li>
<li><a class="reference internal" href="#setting-up-caimanmanager">Setting up caimanmanager</a></li>
</ul>
</li>
<li><a class="reference internal" href="#upgrading">Upgrading</a></li>
<li><a class="reference internal" href="#installing-additional-packages">Installing additional packages</a></li>
</ul>

  <h4>Previous topic</h4>
  <p class="topless"><a href="Overview.html"
                        title="previous chapter">Overview</a></p>
  <h4>Next topic</h4>
  <p class="topless"><a href="Getting_Started.html"
                        title="next chapter">Demos</a></p>
  <div role="note" aria-label="source link">
    <h3>This Page</h3>
    <ul class="this-page-menu">
      <li><a href="_sources/Installation.rst.txt"
            rel="nofollow">Show Source</a></li>
    </ul>
   </div>
<div id="searchbox" style="display: none" role="search">
  <h3>Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="search.html" method="get">
      <input type="text" name="q" />
      <input type="submit" value="Go" />
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
    </div>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="Getting_Started.html" title="Demos"
             >next</a> |</li>
        <li class="right" >
          <a href="Overview.html" title="Overview"
             >previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="index.html">CaImAn 1.4 documentation</a> &#187;</li> 
      </ul>
    </div>
    <div class="footer" role="contentinfo">
        &#169; Copyright 2019, Flatiron Institute, Simons Foundation, New York, NY.
      Created using <a href="http://sphinx-doc.org/">Sphinx</a> 1.8.4.
    </div>
  </body>
</html>